echo "Starting recode process for all UI files..."

# Path to your directory containing the UI files
$rootDir = "D:\a\Tofita\Tofita"

# Get all JSON and HEXA files recursively from the specified directory
$files = Get-ChildItem -Path $rootDir -Recurse | Where-Object { $_.Extension -eq ".json" -or $_.Extension -eq ".hexa" }

if ($files.Count -eq 0) {
    Write-Host "No valid UI files found for recoding."
    exit 0
}

# Loop through all found files and process them
foreach ($file in $files) {
    try {
        Write-Host "Recoding file: $($file.FullName)"

        # Assuming you have a recoding function or command here
        # Example: node ui-recode.js --path $file.FullName --theme Windows11
        node ui-recode.js --path $file.FullName --theme Windows11

    } catch {
        Write-Host "Error processing file $($file.FullName): $_"
        throw "Recode failed for file $($file.FullName)!"
    }
}

Write-Host "Recoding process completed successfully."
